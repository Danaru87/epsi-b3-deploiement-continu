<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Déploiement continu</title>
	<meta name="author" content="David Gayerie">
	<link href="css/article.css" rel="stylesheet" media="screen">
	<link href="css/print-article.css" rel="stylesheet" media="print">
	<link href="highlight/styles/zenburn.css" rel="stylesheet">

	<script src="highlight/highlight.pack.js"></script>
	<script>hljs.initHighlightingOnLoad();</script>
	<script src="js/toc.js"></script>
</head>
<body>
	<div id="titleBar">
 		<a href="https://github.com/spoonless/epsi-b3-deploiement-continu/archive/gh-pages.zip" title="Télécharger tout le cours"><img src="assets/download.png"></a>
		<script>document.write(document.title)</script> - EPSI B3 2016/2017 - <a href="mailto:david.gayerie.epsi@mailoo.org">David Gayerie</a>
		<span class="license"><a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/fr/"><img alt="Licence Creative Commons" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/3.0/fr/80x15.png" /></a></span>
	</div>

	<header>
		<h1>
			<script>document.write(document.title)</script>
		</h1>
	</header>
	<article>
		<ol>
			<li>Les outils
				<ul>
					<li><a href="git.html">Git</a></li>
					<li><a href="lxd.html">LXC/LXD</a> (ou simplement <a href="lxc.html">LXC</a> si votre distribution ne supporte pas LXD)</li>
					<li><a href="ansible.html">Ansible</a></li>
				</ul>
			</li>
			<li><a href="jenkins.html">Jenkins&nbsp;: le serveur d'intégration continue</a></li>
		</ol>
	</article>
	
	<article class="exercice note">
		<section>
			<h2>Projet à rendre&nbsp;: Installation de TomEE dans un conteneur</h2>
			<dl>
				<dt>Objectif</dt>
				<dd>Installer un serveur d'application TomEE dans un conteneur LXC avec ansible.</dd>
			</dl>
			
			<dl>
				<dt>Mise en place</dt>
				<dd>Utilisez le <a href="jenkins.html#exo_ansible">projet ansible</a> d'installation d'un serveur d'intégration continue et ajoutez
				un groupe dans l'inventaire permettant d'installer le serveur d'application TomEE.
				</dd>
			</dl>
			<p>Le serveur TomEE est disponible à cette adresse&nbsp;: 
				<a href="http://repo.maven.apache.org/maven2/org/apache/tomee/apache-tomee/7.0.3/apache-tomee-7.0.3-plus.tar.gz">http://repo.maven.apache.org/maven2/org/apache/tomee/apache-tomee/7.0.3/apache-tomee-7.0.3-plus.tar.gz</a></p>
			</p>
			<p>Pour cet exercice, il va vous falloir installer TomEE comme un service dans un conteneur LXC. Pour cela vous allez devoir
			écrire un playbook ansible pour&nbsp;:
			</p>
			
			<ul>
				<li>Installer le JDK 8 (vous pouvez le paquet <strong><code>openjdk-8-jdk-headless</code></strong> pour installer l'Open JDK présent dans les dépôts de la distribution du conteneur)</li>
				<li>Créer un utilisateur système <code><strong>tomee</strong></code></li>
				<li>Télécharger l'archive de TomEE et installer le serveur dans le répertoire <code><strong>/opt/tomee</strong></code> (ce répertoire doit être la propriété de l'utilisateur tomee)</li>
				<li>Créer un fichier unit systemd pour gérer le service tomee</li>
				<li>S'assurer que le service tomee est lancé à chaque lancement du container</li>
			</ul>
			
			<aside class="tip">
				<p>TomEE est basé sur le conteneur de servlet Tomcat. Cela signifie que l'installation de TomEE est très proche d'une installation de Tomcat.
				Il est très fortement recommandé de consulter <a href="https://www.digitalocean.com/community/tutorials/how-to-install-apache-tomcat-8-on-ubuntu-16-04">cet article</a>
				qui détaille les étapes d'installation manuelle de Tomcat comme service. Il contient notamment un exemple de fichier unit pour systemd. 
				Vous pouvez vous en inspirer et traduire ces étapes en playbook ansible.
				</p>
			</aside>
			

			<dl>
				<dt>Remise du projet</dt>
				<dd>Le format attendu est l'URL de votre dépôt Git contenant le projet ansible.</dd>
			</dl>			
		</section>
	</article>

	<footer class="license">
		<a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/fr/"><img alt="Licence Creative Commons" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/3.0/fr/88x31.png" /></a><br />Cette œuvre est mise à disposition selon les termes de la <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/fr/">Licence Creative Commons Attribution -  Partage dans les Mêmes Conditions 3.0 France</a>.
	</footer>
</body>
</html>
